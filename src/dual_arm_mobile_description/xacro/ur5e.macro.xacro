<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:macro name="ur5e" params="
    parent_link
    prefix:=''
    generate_ros2_control_tag:='false'
    robot_ip:=''
    reverse_port:='50001'
    script_sender_port:='50002'
    script_command_port:='50004'
    trajectory_port:='50003'
    tool_device_name:='/dev/ttyUSB0'
    tool_tcp_port:='54320'
    *origin
    ">
    <xacro:if value="${generate_ros2_control_tag}">
      <ros2_control name="${prefix}arm" type="system">
        <hardware>
          <plugin>ur_robot_driver/URPositionHardwareInterface</plugin>
          <param name="robot_ip">${robot_ip}</param>
          <param name="script_filename">/opt/ros/humble/share/ur_robot_driver/resources/ros_control.urscript</param>
          <param name="output_recipe_filename">/opt/ros/humble/share/ur_robot_driver/resources/rtde_output_recipe.txt</param>
          <param name="input_recipe_filename">/opt/ros/humble/share/ur_robot_driver/resources/rtde_input_recipe.txt</param>
          <param name="headless_mode">True</param>
          <param name="reverse_port">${reverse_port}</param>
          <param name="script_sender_port">${script_sender_port}</param>
          <param name="reverse_ip">0.0.0.0</param>
          <param name="script_command_port">${script_command_port}</param>
          <param name="trajectory_port">${trajectory_port}</param>
          <param name="tf_prefix">${prefix}</param>
          <param name="non_blocking_read">True</param>
          <param name="servoj_gain">2000</param>
          <param name="servoj_lookahead_time">0.03</param>
          <param name="use_tool_communication">True</param>
          <param name="kinematics/hash">calib_12788084448423163542</param>
          <param name="tool_voltage">24</param>
          <param name="tool_parity">0</param>
          <param name="tool_baud_rate">115200</param>
          <param name="tool_stop_bits">1</param>
          <param name="tool_rx_idle_chars">1.5</param>
          <param name="tool_tx_idle_chars">3.5</param>
          <param name="tool_device_name">${tool_device_name}</param>
          <param name="tool_tcp_port">${tool_tcp_port}</param>
          <param name="keep_alive_count">2</param>
        </hardware>
        <joint name="${prefix}shoulder_pan_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">0.0</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <joint name="${prefix}shoulder_lift_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">-1.57</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <joint name="${prefix}elbow_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">0.0</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <joint name="${prefix}wrist_1_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">-1.57</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <joint name="${prefix}wrist_2_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">0.0</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <joint name="${prefix}wrist_3_joint">
          <command_interface name="position"/>
          <command_interface name="velocity"/>
          <state_interface name="position">
            <!-- initial position for the FakeSystem and simulation -->
            <param name="initial_value">0.0</param>
          </state_interface>
          <state_interface name="velocity"/>
          <state_interface name="effort"/>
        </joint>
        <sensor name="${prefix}tcp_fts_sensor">
          <state_interface name="force.x"/>
          <state_interface name="force.y"/>
          <state_interface name="force.z"/>
          <state_interface name="torque.x"/>
          <state_interface name="torque.y"/>
          <state_interface name="torque.z"/>
        </sensor>
        <sensor name="${prefix}tcp_pose">
          <state_interface name="position.x"/>
          <state_interface name="position.y"/>
          <state_interface name="position.z"/>
          <state_interface name="orientation.x"/>
          <state_interface name="orientation.y"/>
          <state_interface name="orientation.z"/>
          <state_interface name="orientation.w"/>
        </sensor>
        <!-- NOTE The following are joints used only for testing with fake hardware and will change in the future -->
        <gpio name="${prefix}speed_scaling">
          <state_interface name="speed_scaling_factor"/>
          <param name="initial_speed_scaling_factor">1</param>
          <command_interface name="target_speed_fraction_cmd"/>
          <command_interface name="target_speed_fraction_async_success"/>
        </gpio>
        <gpio name="${prefix}gpio">
          <command_interface name="standard_digital_output_cmd_0"/>
          <command_interface name="standard_digital_output_cmd_1"/>
          <command_interface name="standard_digital_output_cmd_2"/>
          <command_interface name="standard_digital_output_cmd_3"/>
          <command_interface name="standard_digital_output_cmd_4"/>
          <command_interface name="standard_digital_output_cmd_5"/>
          <command_interface name="standard_digital_output_cmd_6"/>
          <command_interface name="standard_digital_output_cmd_7"/>
          <command_interface name="standard_digital_output_cmd_8"/>
          <command_interface name="standard_digital_output_cmd_9"/>
          <command_interface name="standard_digital_output_cmd_10"/>
          <command_interface name="standard_digital_output_cmd_11"/>
          <command_interface name="standard_digital_output_cmd_12"/>
          <command_interface name="standard_digital_output_cmd_13"/>
          <command_interface name="standard_digital_output_cmd_14"/>
          <command_interface name="standard_digital_output_cmd_15"/>
          <command_interface name="standard_digital_output_cmd_16"/>
          <command_interface name="standard_digital_output_cmd_17"/>
          <command_interface name="standard_analog_output_cmd_0"/>
          <command_interface name="standard_analog_output_cmd_1"/>
          <command_interface name="analog_output_domain_cmd"/>
          <command_interface name="tool_voltage_cmd"/>
          <command_interface name="io_async_success"/>
          <state_interface name="digital_output_0"/>
          <state_interface name="digital_output_1"/>
          <state_interface name="digital_output_2"/>
          <state_interface name="digital_output_3"/>
          <state_interface name="digital_output_4"/>
          <state_interface name="digital_output_5"/>
          <state_interface name="digital_output_6"/>
          <state_interface name="digital_output_7"/>
          <state_interface name="digital_output_8"/>
          <state_interface name="digital_output_9"/>
          <state_interface name="digital_output_10"/>
          <state_interface name="digital_output_11"/>
          <state_interface name="digital_output_12"/>
          <state_interface name="digital_output_13"/>
          <state_interface name="digital_output_14"/>
          <state_interface name="digital_output_15"/>
          <state_interface name="digital_output_16"/>
          <state_interface name="digital_output_17"/>
          <state_interface name="digital_input_0"/>
          <state_interface name="digital_input_1"/>
          <state_interface name="digital_input_2"/>
          <state_interface name="digital_input_3"/>
          <state_interface name="digital_input_4"/>
          <state_interface name="digital_input_5"/>
          <state_interface name="digital_input_6"/>
          <state_interface name="digital_input_7"/>
          <state_interface name="digital_input_8"/>
          <state_interface name="digital_input_9"/>
          <state_interface name="digital_input_10"/>
          <state_interface name="digital_input_11"/>
          <state_interface name="digital_input_12"/>
          <state_interface name="digital_input_13"/>
          <state_interface name="digital_input_14"/>
          <state_interface name="digital_input_15"/>
          <state_interface name="digital_input_16"/>
          <state_interface name="digital_input_17"/>
          <state_interface name="standard_analog_output_0"/>
          <state_interface name="standard_analog_output_1"/>
          <state_interface name="standard_analog_input_0"/>
          <state_interface name="standard_analog_input_1"/>
          <state_interface name="analog_io_type_0"/>
          <state_interface name="analog_io_type_1"/>
          <state_interface name="analog_io_type_2"/>
          <state_interface name="analog_io_type_3"/>
          <state_interface name="tool_mode"/>
          <state_interface name="tool_output_voltage"/>
          <state_interface name="tool_output_current"/>
          <state_interface name="tool_temperature"/>
          <state_interface name="tool_analog_input_0"/>
          <state_interface name="tool_analog_input_1"/>
          <state_interface name="tool_analog_input_type_0"/>
          <state_interface name="tool_analog_input_type_1"/>
          <state_interface name="robot_mode"/>
          <state_interface name="robot_status_bit_0"/>
          <state_interface name="robot_status_bit_1"/>
          <state_interface name="robot_status_bit_2"/>
          <state_interface name="robot_status_bit_3"/>
          <state_interface name="safety_mode"/>
          <state_interface name="safety_status_bit_0"/>
          <state_interface name="safety_status_bit_1"/>
          <state_interface name="safety_status_bit_2"/>
          <state_interface name="safety_status_bit_3"/>
          <state_interface name="safety_status_bit_4"/>
          <state_interface name="safety_status_bit_5"/>
          <state_interface name="safety_status_bit_6"/>
          <state_interface name="safety_status_bit_7"/>
          <state_interface name="safety_status_bit_8"/>
          <state_interface name="safety_status_bit_9"/>
          <state_interface name="safety_status_bit_10"/>
          <state_interface name="program_running"/>
        </gpio>
        <gpio name="${prefix}payload">
          <command_interface name="mass"/>
          <command_interface name="cog.x"/>
          <command_interface name="cog.y"/>
          <command_interface name="cog.z"/>
          <command_interface name="payload_async_success"/>
        </gpio>
        <gpio name="${prefix}resend_robot_program">
          <command_interface name="resend_robot_program_cmd"/>
          <command_interface name="resend_robot_program_async_success"/>
        </gpio>
        <gpio name="${prefix}hand_back_control">
          <command_interface name="hand_back_control_cmd"/>
          <command_interface name="hand_back_control_async_success"/>
        </gpio>
        <gpio name="${prefix}zero_ftsensor">
          <command_interface name="zero_ftsensor_cmd"/>
          <command_interface name="zero_ftsensor_async_success"/>
        </gpio>
        <gpio name="${prefix}system_interface">
          <state_interface name="initialized"/>
        </gpio>
        <gpio name="${prefix}get_robot_software_version">
          <state_interface name="get_version_major"/>
          <state_interface name="get_version_minor"/>
          <state_interface name="get_version_build"/>
          <state_interface name="get_version_bugfix"/>
        </gpio>
      </ros2_control>
    </xacro:if>
    <!-- Add URDF transmission elements (for ros_control) -->
    <!--<xacro:ur_arm_transmission prefix="${prefix}" hw_interface="${transmission_hw_interface}" />-->
    <!-- Placeholder for ros2_control transmission which don't yet exist -->
    <!-- links -  main serial chain -->
    <link name="${prefix}base_link"/>
    <link name="${prefix}base_link_inertia">
      <visual>
        <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/base.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/base.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="4.0"/>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <inertia ixx="0.00443333156" ixy="0.0" ixz="0.0" iyy="0.00443333156" iyz="0.0" izz="0.0072"/>
      </inertial>
    </link>
    <link name="${prefix}shoulder_link">
      <visual>
        <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/shoulder.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/shoulder.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="3.761"/>
        <origin rpy="0 0 0" xyz="0.0 -0.00193 -0.02561"/>
        <inertia ixx="0.010267499999999999" ixy="0" ixz="0" iyy="0.010267499999999999" iyz="0" izz="0.00666"/>
      </inertial>
    </link>
    <link name="${prefix}upper_arm_link">
      <visual>
        <origin rpy="1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0.138"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/upperarm.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0.138"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/upperarm.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="8.058"/>
        <origin rpy="0 1.570796326794897 0" xyz="-0.2125 0.0 0.11336"/>
        <inertia ixx="0.13388583541666665" ixy="0" ixz="0" iyy="0.13388583541666665" iyz="0" izz="0.0151074"/>
      </inertial>
    </link>
    <link name="${prefix}forearm_link">
      <visual>
        <origin rpy="1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0.007"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/forearm.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0.007"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/forearm.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="2.846"/>
        <origin rpy="0 1.570796326794897 0" xyz="-0.2422 0.0 0.0265"/>
        <inertia ixx="0.03120936758333333" ixy="0" ixz="0" iyy="0.03120936758333333" iyz="0" izz="0.004095"/>
      </inertial>
    </link>
    <link name="${prefix}wrist_1_link">
      <visual>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0 -0.127"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/wrist1.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0 -0.127"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/wrist1.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="1.37"/>
        <origin rpy="0 0 0" xyz="0.0 -0.01634 -0.0018"/>
        <inertia ixx="0.0025599" ixy="0" ixz="0" iyy="0.0025599" iyz="0" izz="0.0021942"/>
      </inertial>
    </link>
    <link name="${prefix}wrist_2_link">
      <visual>
        <origin rpy="0 0 0" xyz="0 0 -0.0997"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/wrist2.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 0" xyz="0 0 -0.0997"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/wrist2.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="1.3"/>
        <origin rpy="0 0 0" xyz="0.0 0.01634 -0.0018"/>
        <inertia ixx="0.0025599" ixy="0" ixz="0" iyy="0.0025599" iyz="0" izz="0.0021942"/>
      </inertial>
    </link>
    <link name="${prefix}wrist_3_link">
      <visual>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0 -0.0989"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/visual/wrist3.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0 -0.0989"/>
        <geometry>
          <mesh filename="package://ur_description/meshes/ur5e/collision/wrist3.stl"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="0.365"/>
        <origin rpy="0 0 0" xyz="0.0 0.0 -0.001159"/>
        <inertia ixx="9.890414008333333e-05" ixy="0" ixz="0" iyy="9.890414008333333e-05" iyz="0" izz="0.0001321171875"/>
      </inertial>
    </link>
    <!-- base_joint fixes base_link to the environment -->
    <joint name="${prefix}base_joint" type="fixed">
      <xacro:insert_block name="origin"/>
      <parent link="${parent_link}"/>
      <child link="${prefix}base_link"/>
    </joint>
    <!-- joints - main serial chain -->
    <joint name="${prefix}base_link-base_link_inertia" type="fixed">
      <parent link="${prefix}base_link"/>
      <child link="${prefix}base_link_inertia"/>
      <!-- 'base_link' is REP-103 aligned (so X+ forward), while the internal
             frames of the robot/controller have X+ pointing backwards.
             Use the joint between 'base_link' and 'base_link_inertia' (a dummy
             link/frame) to introduce the necessary rotation over Z (of pi rad).
        -->
      <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
    </joint>
    <joint name="${prefix}shoulder_pan_joint" type="revolute">
      <parent link="${prefix}base_link_inertia"/>
      <child link="${prefix}shoulder_link"/>
      <origin rpy="0 0 0" xyz="0 0 0.1625"/>
      <axis xyz="0 0 1"/>
      <limit effort="150.0" lower="-6.283185307179586" upper="6.283185307179586" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <joint name="${prefix}shoulder_lift_joint" type="revolute">
      <parent link="${prefix}shoulder_link"/>
      <child link="${prefix}upper_arm_link"/>
      <origin rpy="1.570796327 0 0" xyz="0 0 0"/>
      <axis xyz="0 0 1"/>
      <limit effort="150.0" lower="-6.283185307179586" upper="6.283185307179586" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <joint name="${prefix}elbow_joint" type="revolute">
      <parent link="${prefix}upper_arm_link"/>
      <child link="${prefix}forearm_link"/>
      <origin rpy="0 0 0" xyz="-0.425 0 0"/>
      <axis xyz="0 0 1"/>
      <limit effort="150.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <joint name="${prefix}wrist_1_joint" type="revolute">
      <parent link="${prefix}forearm_link"/>
      <child link="${prefix}wrist_1_link"/>
      <origin rpy="0 0 0" xyz="-0.3922 0 0.1333"/>
      <axis xyz="0 0 1"/>
      <limit effort="28.0" lower="-6.283185307179586" upper="6.283185307179586" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <joint name="${prefix}wrist_2_joint" type="revolute">
      <parent link="${prefix}wrist_1_link"/>
      <child link="${prefix}wrist_2_link"/>
      <origin rpy="1.570796327 0 0" xyz="0 -0.0997 -2.044881182297852e-11"/>
      <axis xyz="0 0 1"/>
      <limit effort="28.0" lower="-6.283185307179586" upper="6.283185307179586" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <joint name="${prefix}wrist_3_joint" type="revolute">
      <parent link="${prefix}wrist_2_link"/>
      <child link="${prefix}wrist_3_link"/>
      <origin rpy="1.570796326589793 3.141592653589793 3.141592653589793" xyz="0 0.0996 -2.042830148012698e-11"/>
      <axis xyz="0 0 1"/>
      <limit effort="28.0" lower="-6.283185307179586" upper="6.283185307179586" velocity="3.141592653589793"/>
      <dynamics damping="0" friction="0"/>
    </joint>
    <link name="${prefix}ft_frame"/>
    <joint name="${prefix}wrist_3_link-ft_frame" type="fixed">
      <parent link="${prefix}wrist_3_link"/>
      <child link="${prefix}ft_frame"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
    </joint>
    <!-- ROS-Industrial 'base' frame - base_link to UR 'Base' Coordinates transform -->
    <link name="${prefix}base"/>
    <joint name="${prefix}base_link-base_fixed_joint" type="fixed">
      <!-- Note the rotation over Z of pi radians - as base_link is REP-103
             aligned (i.e., has X+ forward, Y+ left and Z+ up), this is needed
             to correctly align 'base' with the 'Base' coordinate system of
             the UR controller.
        -->
      <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
      <parent link="${prefix}base_link"/>
      <child link="${prefix}base"/>
    </joint>
    <!-- ROS-Industrial 'flange' frame - attachment point for EEF models -->
    <link name="${prefix}flange"/>
    <joint name="${prefix}wrist_3-flange" type="fixed">
      <parent link="${prefix}wrist_3_link"/>
      <child link="${prefix}flange"/>
      <origin rpy="0 -1.5707963267948966 -1.5707963267948966" xyz="0 0 0"/>
    </joint>
    <!-- ROS-Industrial 'tool0' frame - all-zeros tool frame -->
    <link name="${prefix}tool0"/>
    <joint name="${prefix}flange-tool0" type="fixed">
      <!-- default toolframe - X+ left, Y+ up, Z+ front -->
      <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0 0 0"/>
      <parent link="${prefix}flange"/>
      <child link="${prefix}tool0"/>
    </joint>
    <joint name="${prefix}realsense_camera_adapter_joint" type="fixed">
      <!-- The parent link must be read from the robot model it is attached to. -->
      <parent link="${prefix}tool0"/>
      <child link="${prefix}realsense_camera_adapter_link"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
    </joint>
    <link name="${prefix}realsense_camera_adapter_link">
      <visual>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <geometry>
          <mesh
              filename="package://picknik_accessories/descriptions/brackets/ur_realsense_camera_adapter/picknik_ur5_realsense_camera_adapter_rev2.dae"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <geometry>
          <mesh
              filename="package://picknik_accessories/descriptions/brackets/ur_realsense_camera_adapter/picknik_ur5_realsense_camera_adapter_rev2_collision.stl"/>
        </geometry>
      </collision>
    </link>
    <link name="${prefix}realsense_camera_adapter_tool0"/>
    <joint name="${prefix}realsense_camera_adapter_tool0_joint" type="fixed">
      <parent link="${prefix}realsense_camera_adapter_link"/>
      <child link="${prefix}realsense_camera_adapter_tool0"/>
      <origin rpy="0 0 0" xyz="0 0 0.007"/>
    </joint>
    <link name="${prefix}d415_mount_link"/>
    <joint name="${prefix}d415_mount_joint" type="fixed">
      <parent link="${prefix}realsense_camera_adapter_link"/>
      <child link="${prefix}d415_mount_link"/>
      <origin rpy="0 -1.4660765716752369 1.5707963267948966" xyz="0 -0.067 0.0171"/>
    </joint>
    <link name="${prefix}l515_mount_link"/>
    <joint name="${prefix}l515_mount_joint" type="fixed">
      <parent link="${prefix}realsense_camera_adapter_link"/>
      <child link="${prefix}l515_mount_link"/>
      <origin rpy="0 -1.4660765716752369 1.5707963267948966" xyz="0 -0.0406 0.0173"/>
    </joint>
    <!-- camera body, with origin at bottom screw mount -->
    <joint name="${prefix}wrist_mounted_camera_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <parent link="${prefix}d415_mount_link"/>
      <child link="${prefix}wrist_mounted_camera_bottom_screw_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_bottom_screw_frame"/>
    <joint name="${prefix}wrist_mounted_camera_link_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.02 0.0115"/>
      <parent link="${prefix}wrist_mounted_camera_bottom_screw_frame"/>
      <child link="${prefix}wrist_mounted_camera_link"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_link">
      <visual>
        <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0.00987 -0.02 0"/>
        <geometry>
          <mesh filename="package://realsense2_description/meshes/d415.stl"/>
        </geometry>
        <material name="rs_aluminum">
          <color rgba="0.5 0.5 0.5 1.0"/>
        </material>
      </visual>
      <collision>
        <origin rpy="0 0 0" xyz="0 -0.02 0"/>
        <geometry>
          <box size="0.02005 0.099 0.023"/>
        </geometry>
      </collision>
      <inertial>
        <mass value="0.072"/>
        <!-- The following are not reliable values, and should not be used for modeling -->
        <origin xyz="0 0 0"/>
        <inertia ixx="0.003881243" ixy="0.0" ixz="0.0" iyy="0.000498940" iyz="0.0" izz="0.003879257"/>
      </inertial>
    </link>
    <!-- camera depth joints and links -->
    <joint name="${prefix}wrist_mounted_camera_depth_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <parent link="${prefix}wrist_mounted_camera_link"/>
      <child link="${prefix}wrist_mounted_camera_depth_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_depth_frame"/>
    <joint name="${prefix}wrist_mounted_camera_depth_optical_joint" type="fixed">
      <origin rpy="-1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0"/>
      <parent link="${prefix}wrist_mounted_camera_depth_frame"/>
      <child link="${prefix}wrist_mounted_camera_depth_optical_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_depth_optical_frame"/>
    <!-- camera left IR joints and links -->
    <joint name="${prefix}wrist_mounted_camera_infra1_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.0 0"/>
      <parent link="${prefix}wrist_mounted_camera_link"/>
      <child link="${prefix}wrist_mounted_camera_infra1_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_infra1_frame"/>
    <joint name="${prefix}wrist_mounted_camera_infra1_optical_joint" type="fixed">
      <origin rpy="-1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0"/>
      <parent link="${prefix}wrist_mounted_camera_infra1_frame"/>
      <child link="${prefix}wrist_mounted_camera_infra1_optical_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_infra1_optical_frame"/>
    <!-- camera right IR joints and links -->
    <joint name="${prefix}wrist_mounted_camera_infra2_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 -0.055 0"/>
      <parent link="${prefix}wrist_mounted_camera_link"/>
      <child link="${prefix}wrist_mounted_camera_infra2_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_infra2_frame"/>
    <joint name="${prefix}wrist_mounted_camera_infra2_optical_joint" type="fixed">
      <origin rpy="-1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0"/>
      <parent link="${prefix}wrist_mounted_camera_infra2_frame"/>
      <child link="${prefix}wrist_mounted_camera_infra2_optical_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_infra2_optical_frame"/>
    <!-- camera color joints and links -->
    <joint name="${prefix}wrist_mounted_camera_color_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.015 0"/>
      <parent link="${prefix}wrist_mounted_camera_link"/>
      <child link="${prefix}wrist_mounted_camera_color_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_color_frame"/>
    <joint name="${prefix}wrist_mounted_camera_color_optical_joint" type="fixed">
      <origin rpy="-1.5707963267948966 0 -1.5707963267948966" xyz="0 0 0"/>
      <parent link="${prefix}wrist_mounted_camera_color_frame"/>
      <child link="${prefix}wrist_mounted_camera_color_optical_frame"/>
    </joint>
    <link name="${prefix}wrist_mounted_camera_color_optical_frame"/>
  </xacro:macro>
</robot>
